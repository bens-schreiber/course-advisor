<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Course Advisor</title>
    <link href="styles.css" rel="stylesheet" />
    <script
      src="https://unpkg.com/htmx.org@2.0.4"
      integrity="sha384-HGfztofotfshcF7+8n44JQL2oJmowVChPTg48S+jvZoztPfvwD79OC/LTtG6dMp+"
      crossorigin="anonymous"
    ></script>
    <script src="//unpkg.com/alpinejs" defer></script>
  </head>
  <body>
    <main>

      <div x-data="{ 
        courses: [], 
        selectedCourse: null,
        searchText: '',
        topProfessors: []
      }" x-init="fetch('/api/v1/courses/search').then(r => r.json()).then(data => courses = data)">
        
        <!-- Course selection -->
        <input 
          list="course-list" 
          x-model="searchText"
          @change="selectedCourse = courses.find(c => c.name === searchText)"
          placeholder="Select a course"
        >
        
        <datalist id="course-list">
          <template x-for="course in courses" :key="course.id">
            <option :value="course.name"></option>
          </template>
        </datalist>
        
        <!-- Go button -->
        <button
          @click="if(selectedCourse) fetch(`/api/v1/top_professors?course_id=${selectedCourse.id}`).then(r => r.json()).then(data => topProfessors = data)"
          :disabled="!selectedCourse"
        >
          Go
        </button>
        
        <!-- Results section -->
        <div x-show="topProfessors.length > 0" class="professors-results">
          <h3>Top Professors for <span x-text="selectedCourse?.name"></span></h3>
          <ul>
            <template x-for="professor in topProfessors" :key="professor.id">
              <li x-text="professor.name"></li>
            </template>
          </ul>
        </div>
        
        <!-- No results message -->
        <div x-show="selectedCourse && topProfessors.length === 0 && topProfessors.requested">
          No professors found for this course.
        </div>
      </div>

    </main>
    <footer></footer>
  </body>
</html>
